<!DOCTYPE html>
<script>
    "use strict";
    // Add/remove items
    // - splice
    //arr.splice(start[, deleteCount, elem1, ..., elemN])
    let arr = ["I", "study", "JavaScript", "right", "now"];
    // remove 3 first elements and replace them with another
    arr.splice(0, 3, "Let's", "dance");
    alert( arr ) // now ["Let's", "dance", "right", "now"]

    // - slice It returns a new array copying to it all 
    // items from index start to end (not incl)
    let arr_ = ["t", "e", "s", "t"];
    alert( arr_.slice(1, 3) ); // e,s (copy from 1 to 3)
    alert( arr_.slice(-2) ); // s,t (copy from -2 till the end)

    // - concat - new array that incl values from toher arrays
    // arr.concat(arg1, arg2..)
    let arr2 = [1, 2];
    // create an array from: arr and [3,4]
    alert( arr2.concat([3, 4]) ); // 1,2,3,4
    // create an array from: arr and [3,4] and [5,6]
    alert( arr2.concat([3, 4], [5, 6]) ); // 1,2,3,4,5,6

    // - forEach
    // The arr.forEach method allows to run a function for every element of the array.
    // for each element call alert
    ["Bilbo", "Gandalf", "Nazgul"].forEach(alert);

    ["Bilbo", "Gandalf", "Nazgul"].forEach((item, index, array) => {
    alert(`${item} is at index ${index} in ${array}`);
    });

    // - searching in array
    // indexOf/lastIndexOf and includes
    let fruits = ['Apple', 'Orange', 'Apple']
    alert( fruits.indexOf('Apple') ); // 0 (first Apple)
    alert( fruits.lastIndexOf('Apple') ); // 2 (last Apple)
    // The includes method handles NaN correctly

    // find and findIndex/findLastIndex
    let users = [
        {id: 1, name: "John"},
        {id: 2, name: "Pete"},
        {id: 3, name: "Mary"}
    ];

    let user = users.find(item => item.id == 1); // find(function(item, index, array));
    alert(user.name); // John
    // Find the index of the first John
    alert(users.findIndex(user => user.name == 'John')); // 0

    // Find the index of the last John
    alert(users.findLastIndex(user => user.name == 'John')); // 3

    // filter
    // find looks for single(first) element that returns true
    // if there are many such, we ise arr.filter(function)
    let allUsers = [
        {id: 1, name: "John"},
        {id: 2, name: "Pete"},
        {id: 3, name: "Mary"}
    ];
    let someUsers = allUsers.filter(item => item.id < 3);
    alert(someUsers.length); // 2

    // TRANSFORM an array

    // - map - calls funciton for EACH element and returns array 
    let lengths = ["Bilbo", "Gandalf", "Nazgul"].map(item => item.length);
    alert(lengths); // 5,7,6

    // - sort(fn) - The call to arr.sort() sorts the array in place, changing its element order.
    let l1st = [1, 2, 15];
    arr.sort();
    alert(arr); // sorted as strings, result is 1, 15, 2
    function compare(a, b){
        if(a > b) return 1;
        if(a == b) return 0;
        if(a < b) return -1;
    }
    let a = [1, 2, 15];
    arr.sort(compare);
    alert(arr); // 1, 2, 15

    let a1 = [ 1, 2, 15 ];
    a1.sort(function(a, b) { return a - b; });
    alert(a1);  // 1, 2, 15

    // - reverse - reverses order of array
    let s = [1, 2, 3, 4, 5];
    s.reverse();

    alert( s ); // 5,4,3,2,1

    // - split and join
    let names = 'Bilbo, Gandalf, Nazgul';

    let new_arr = names.split(', ');
    for (let name of new_arr) {
    alert( `A message to ${name}.` ); // A message to Bilbo  (and other names)
    }

    //split into letters
    let word = "test";
    alert( word.split('') ); // t,e,s,t

    // arr.join(glue) - reverse of split
    let collection = ['Bilbo', 'Gandalf', 'Nazgul'];
    let join_str = collection.join(';'); // glue the array into a string using ;
    alert( join_str ); // Bilbo;Gandalf;Nazgul

    //reduce/reduceRight - calc single value based on the array
    // syntax:
    // let value = arr.reduce(function(accumulator, item, index, array) {...}, [initial]);
    let b = [1, 2, 3, 4, 5];
    let result = b.reduce((sum, current) => sum + current, 0);
    alert(result); // 15



    // - - TASKS - -

    // 1
    function camelize(str) {
    return str.split('-').map(
        (word, index) => index == 0 ? word : word[0].toUpperCase() + word.slice(1)
        ).join('');
    }

    // 2
    function filterRange(arr, a, b){
        arr.filter(item => (item >= a && item <= b));
    }
    let aa = [5, 3, 8, 1];
    let filtered = filterRange(aa, 1, 4);
    alert( filtered ); // 3,1 (matching values)
    alert( aa ); // 5,3,8,1 (not modified)



    // 3
    function filterRangeInPlace(arr, a, b) {

    for (let i = 0; i < arr.length; i++) {
        let val = arr[i];

        // remove if outside of the interval
        if (val < a || val > b) {
        arr.splice(i, 1);
        i--;
        }
    }

    }


    // 4
    arr.sort((a, b) => b - a);

    alert( arr );

    // 5
    function copySorted(arr) {
        return arr.slice().sort();
    }   

    // 6
    function Calculator() {
        this.methods = {
            "-": (a, b) => a - b,
            "+": (a, b) => a + b
        };

        this.calculate = function(str) {

            let split = str.split(' '),
            a = +split[0],
            op = split[1],
            b = +split[2];

            if (!this.methods[op] || isNaN(a) || isNaN(b)) {
            return NaN;
            }

            return this.methods[op](a, b);
        };

        this.addMethod = function(name, func) {
            this.methods[name] = func;
        };
    }

    // 7
    function getAverageAge(users) {
        return users.reduce((prev, user) => prev + user.age, 0) / users.length;
    }

    let john = { name: "John", age: 25 };
    let pete = { name: "Pete", age: 30 };
    let mary = { name: "Mary", age: 29 };

    // 8 
    function groupById(array) {
        return array.reduce((obj, value) => {
            obj[value.id] = value;
            return obj;
        }, {})
    }

    














</script>